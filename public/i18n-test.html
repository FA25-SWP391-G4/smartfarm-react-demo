<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>I18n Test Page</title>
  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
    integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM"
    crossorigin="anonymous"
  />
  <style>
    body { padding: 20px; }
    .lang-btn { margin-right: 5px; }
  </style>
</head>
<body>
  <div class="container">
    <h1>I18n Implementation Test</h1>
    <p>This page tests if the i18n implementation is working correctly.</p>
    
    <div class="mb-4">
      <h3>Select Language</h3>
      <button id="en-btn" class="btn btn-primary lang-btn">üá¨üáß English</button>
      <button id="vi-btn" class="btn btn-primary lang-btn">üáªüá≥ Ti·∫øng Vi·ªát</button>
    </div>
    
    <div class="card mb-4">
      <div class="card-header">
        <h4>Common Phrases</h4>
      </div>
      <div class="card-body">
        <table class="table">
          <thead>
            <tr>
              <th>Key</th>
              <th>Translation</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>common.submit</td>
              <td id="common-submit"></td>
            </tr>
            <tr>
              <td>common.cancel</td>
              <td id="common-cancel"></td>
            </tr>
            <tr>
              <td>common.delete</td>
              <td id="common-delete"></td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    
    <div class="card mb-4">
      <div class="card-header">
        <h4>Navigation Items</h4>
      </div>
      <div class="card-body">
        <table class="table">
          <thead>
            <tr>
              <th>Key</th>
              <th>Translation</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>navigation.home</td>
              <td id="nav-home"></td>
            </tr>
            <tr>
              <td>navigation.dashboard</td>
              <td id="nav-dashboard"></td>
            </tr>
            <tr>
              <td>navigation.zones</td>
              <td id="nav-zones"></td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    
    <div class="card mb-4">
      <div class="card-header">
        <h4>Zones Page</h4>
      </div>
      <div class="card-body">
        <table class="table">
          <thead>
            <tr>
              <th>Key</th>
              <th>Translation</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>zones.title</td>
              <td id="zones-title"></td>
            </tr>
            <tr>
              <td>zones.createZone</td>
              <td id="zones-create"></td>
            </tr>
            <tr>
              <td>zones.noDevices</td>
              <td id="zones-no-devices"></td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div class="card mb-4">
      <div class="card-header">
        <h4>Translation API Test</h4>
      </div>
      <div class="card-body">
        <button id="test-api" class="btn btn-info">Test /api/language/available</button>
        <div id="api-result" class="mt-3 p-3 border rounded"></div>
      </div>
    </div>
  </div>

  <script>
    // Simplified version of translations for testing
    const translations = {
      en: {
        common: {
          submit: "Submit",
          cancel: "Cancel",
          delete: "Delete"
        },
        navigation: {
          home: "Home",
          dashboard: "Dashboard",
          zones: "Zones"
        },
        zones: {
          title: "Manage Multiple Plant Zones",
          createZone: "Create Zone",
          noDevices: "No unassigned devices available"
        }
      },
      vi: {
        common: {
          submit: "G·ª≠i",
          cancel: "H·ªßy b·ªè",
          delete: "X√≥a"
        },
        navigation: {
          home: "Trang ch·ªß",
          dashboard: "B·∫£ng ƒëi·ªÅu khi·ªÉn",
          zones: "Khu v∆∞·ªùn"
        },
        zones: {
          title: "Qu·∫£n l√Ω nhi·ªÅu khu v∆∞·ªùn",
          createZone: "T·∫°o khu v∆∞·ªùn",
          noDevices: "Kh√¥ng c√≤n thi·∫øt b·ªã tr·ªëng"
        }
      }
    };

    // Current language
    let currentLang = 'en';

    // Function to translate the page
    function translatePage(lang) {
      currentLang = lang;
      
      // Update common phrases
      document.getElementById('common-submit').textContent = translations[lang].common.submit;
      document.getElementById('common-cancel').textContent = translations[lang].common.cancel;
      document.getElementById('common-delete').textContent = translations[lang].common.delete;
      
      // Update navigation items
      document.getElementById('nav-home').textContent = translations[lang].navigation.home;
      document.getElementById('nav-dashboard').textContent = translations[lang].navigation.dashboard;
      document.getElementById('nav-zones').textContent = translations[lang].navigation.zones;
      
      // Update zones page
      document.getElementById('zones-title').textContent = translations[lang].zones.title;
      document.getElementById('zones-create').textContent = translations[lang].zones.createZone;
      document.getElementById('zones-no-devices').textContent = translations[lang].zones.noDevices;
      
      // Update buttons
      document.getElementById('en-btn').classList.toggle('btn-primary', lang === 'en');
      document.getElementById('en-btn').classList.toggle('btn-outline-primary', lang !== 'en');
      document.getElementById('vi-btn').classList.toggle('btn-primary', lang === 'vi');
      document.getElementById('vi-btn').classList.toggle('btn-outline-primary', lang !== 'vi');
      
      // Store in localStorage (simulating the behavior of i18next)
      localStorage.setItem('i18nextLng', lang);
    }

    // Initialize with English
    translatePage('en');

    // Event listeners for language buttons
    document.getElementById('en-btn').addEventListener('click', () => translatePage('en'));
    document.getElementById('vi-btn').addEventListener('click', () => translatePage('vi'));
    
    // API test
    document.getElementById('test-api').addEventListener('click', async () => {
      const resultElement = document.getElementById('api-result');
      
      try {
        resultElement.innerHTML = 'Testing API...';
        const response = await fetch('/api/language/available');
        const data = await response.json();
        
        resultElement.innerHTML = `<div class="text-success">‚úÖ API test successful</div>
                                  <pre>${JSON.stringify(data, null, 2)}</pre>`;
      } catch (error) {
        resultElement.innerHTML = `<div class="text-danger">‚ùå API test failed</div>
                                  <pre>${error.message}</pre>`;
      }
    });
  </script>
</body>
</html>